const c=document.getElementById("mobile-menu-btn"),s=document.getElementById("mobile-menu");c?.addEventListener("click",()=>{s?.classList.toggle("hidden"),c.classList.toggle("rotate-90")});document.addEventListener("click",e=>{const t=e.target;!s?.contains(t)&&!c?.contains(t)&&(s?.classList.add("hidden"),c?.classList.remove("rotate-90"))});function f(e){e.preventDefault();const i=e.target.querySelector("input")?.value.trim();i&&(window.location.href=`/figuras?search=${encodeURIComponent(i)}`)}function p(){const e=document.getElementById("cart-count"),t=JSON.parse(localStorage.getItem("figure-store")||'{"cart": {}, "wishlist": []}'),a=Object.values(t.cart).reduce((i,n)=>i+n,0);e&&(a>0?(e.textContent=a.toString(),e.classList.remove("hidden"),e.classList.add("animate-pulse"),setTimeout(()=>e.classList.remove("animate-pulse"),1e3)):e.classList.add("hidden"))}p();window.addEventListener("storage",p);window.addEventListener("cartUpdated",p);document.addEventListener("keydown",e=>{e.key==="Escape"&&s&&!s.classList.contains("hidden")&&(s.classList.add("hidden"),c?.classList.remove("rotate-90")),(e.ctrlKey||e.metaKey)&&e.key==="k"&&(e.preventDefault(),(document.getElementById("header-search")||document.getElementById("mobile-search"))?.focus())});window.handleSearch=f;const m=document.getElementById("cart-modal"),E=document.getElementById("close-cart"),d=document.getElementById("cart-items"),G=document.getElementById("empty-cart"),g=document.getElementById("cart-total"),v=document.getElementById("clear-cart"),w=document.getElementById("checkout-cart"),M={1:{name:"Yotsuba Koiwai",price:500,image:"/YotsubaActionFigureYotsubaKoiwai/YotsubaActionFigureYotsubaKoiwai1.jpg"},2:{name:"GGG Series Mobile Suit Zeta Gundam Haman Karn 1/8",price:500,image:"/GGGSeriesMobileSuitZetaGundamHamanKarn/GGGSeriesMobileSuitZetaGundamHamanKarn1.jpg"},3:{name:"Nendoroid Petite - B.G.M Festival Set Vol.0",price:100,image:"/Nendoroidpetite/Nendoroidpetite1.jpg"},4:{name:"Granblue Fantasy - Charlotta - 1/8",price:1e3,image:"/GRANBLUEFANTASYCharlotta/GRANBLUEFANTASYCharlotta1.jpg"},5:{name:"Odin Sphere - Gwendolyn 1/8 Complete Figure",price:500,image:"/OdinSphereGwendolyn/OdinSphereGwendolyn1.jpg"},6:{name:"Odin Sphere - Mercedes 1/8 Complete Figure",price:500,image:"/OdinSphereMercedes/OdinSphereMercedes1.jpg"},7:{name:"Odin Sphere - Velvet with Cornelius 1/8 Complete Figure",price:500,image:"/OdinSphereVelvetwithCornelius/OdinSphereVelvetwithCornelius1.jpg"},8:{name:"GGG Series Mobile Suit Gundam 0083 STARDUST MEMORY - Anavel Gato 1/8",price:500,image:"/GGGSeriesMobileSuitGundam0083AnavelGato/GGGSeriesMobileSuitGundam0083Anavel Gato1.jpg"},9:{name:"Excellent Model RAHDX G.A.NEO Mobile Suit Gundam Ramba Ral 1/8",price:500,image:"/MobileSuitGundamRambaRal/MobileSuitGundamRambaRal1.jpg"},10:{name:"Yamato Guys Collection - Space Battleship Yamato 2199: Juzo Okita 1/8 Complete Figure",price:500,image:"/Yamato2199JuzoOkita/Yamato2199JuzoOkita1.jpg"},11:{name:"1/100 MG MS-07B-3 Gouf Custom",price:200,image:"/1100MGMSGoufCustom/1100MGMSGoufCustom1.jpg"},12:{name:"1/100 MG Qubeley",price:300,image:"/1100MGQubeley/1100MGQubeley1.jpg"},13:{name:"THE iDOLM@STER Cinderella Girls - Anastasia - 1/8 - Memories Ver. (Alter)",price:500,image:"/CinderellaGirlsAnastasia/CinderellaGirlsAnastasia1.jpg"},14:{name:"THE iDOLM@STER Cinderella Girls - Nitta Minami - 1/8 - Memories Ver. (Alter)",price:500,image:"/CinderellaGirlsNittaMinami/CinderellaGirlsNittaMinami1.jpg"},15:{name:"THE iDOLM@STER Cinderella Girls - Kanzaki Ranko - 1/8 - Memories Ver. (Alter)",price:500,image:"/CinderellaGirlsKanzakiRanko/CinderellaGirlsKanzakiRanko1.jpg"},16:{name:"GRANBLUE FANTASY - Danua 1/8 Complete Figure",price:500,image:"/GRANBLUEFANTASYDanua/GRANBLUEFANTASYDanua1.jpg"},17:{name:"GUILTY GEAR Xrd -SIGN- Elphelt Valentine 1/7 Complete Figure",price:500,image:"/GUILTYGEARElpheltValentine/GUILTYGEARElpheltValentine1.jpg"},18:{name:"Excellent Model Shinra Bansho Choco - Masenki Asmodies 1/8 Complete Figure",price:500,image:"/ShinraBanshoChocoMasenkiAsmodies/ShinraBanshoChocoMasenkiAsmodies1.jpg"},19:{name:"Excellent Model - Shinra Bansho Choco: Mashougun Astaroth 1/8 Complete Figure",price:500,image:"/ShinraBanshoChocoMashougunAstaroth/ShinraBanshoChocoMashougunAstaroth1.jpg"},20:{name:"THE IDOLM@STER Cinderella Girls - Sachiko Koshimizu Self-Proclaimed Cute Ver. (Regular Edition) 1/8 Complete Figure",price:300,image:"/CinderellaGirlsSachikoKoshimizu/CinderellaGirlsSachikoKoshimizu1.jpg"},21:{name:"Nendoroid - Snow Miku Magical Snow 2014",price:500,image:"/NendoroidSnowMikuMagicalSnow2014/NendoroidSnowMikuMagicalSnow1.jpg"},22:{name:"Golgo 13 - Duke Togo - Figma (#042) (Max Factory)",price:500,image:"/figmaGolgo/figmaGolgo1.jpg"},23:{name:"Triggerheart Exelica - Exelica 1/8 Complete Figure",price:800,image:"/TriggerheartExelicaExelica/TriggerheartExelicaExelica1.jpg"},24:{name:"Orchid Seed Seven Deadly Sins Leviathan 1/7 PVC",price:500,image:"/OrchidSeedSevenDeadlySinsLeviathan/OrchidSeedSevenDeadlySinsLeviathan1.jpg"},25:{name:"Nendoroid - Hatsune Miku Halloween 2014",price:500,image:"/NendoroidHatsuneMikuHalloween/NendoroidHatsuneMikuHalloween1.jpg"},26:{name:"Character Vocal Series 01 Hatsune Miku Tell Your World Ver. 1/8 Complete Figure",price:750,image:"/HatsuneMikuTellYourWorld/HatsuneMikuTellYourWorld1.jpg"},27:{name:"Grimoire of Zero - Zero 1/8 Complete Figure",price:800,image:"/GrimoireofZeroZero/GrimoireofZeroZero1.jpg"},28:{name:"THE IDOLM@STER Cinderella Girls - Riina Tada 1/8 Complete Figure",price:500,image:"/THEiDOLMASTERCinderellaGirlsTadaRiina/THEiDOLMASTERCinderellaGirlsTadaRiina1.jpg"},101:{name:"Nendoroid Hatsune Miku: Sailor Uniform",price:500,image:"/NendoroidHatsuneMikuSailorUniform/NendoroidHatsuneMikuSailorUniform1.jpg"},102:{name:"Nendoroid - UTAU: Teto Kasane",price:500,image:"/NendoroidUTAUTetoKasane/NendoroidUTAUTetoKasane1.jpg"}};function k(){m?.classList.remove("hidden"),u()}function h(){m?.classList.add("hidden")}function u(){const t=JSON.parse(localStorage.getItem("figure-store")||'{"cart": {}, "wishlist": []}').cart;if(Object.keys(t).length===0){G?.classList.remove("hidden"),d?.classList.add("hidden"),g.textContent="S/0";return}G?.classList.add("hidden"),d?.classList.remove("hidden");let a=0,i="";Object.entries(t).forEach(([n,r])=>{const o=M[n];if(o){const l=o.price*r;a+=l,i+=`
          <div class="flex items-center gap-3 py-3 border-b last:border-b-0">
            <img src="${o.image}" alt="${o.name}" class="w-16 h-16 object-cover rounded-lg" onerror="this.src='/placeholder-figure.svg'; this.onerror=null;">
            <div class="flex-1">
              <h4 class="font-medium text-sm">${o.name}</h4>
              <p class="text-gray-500 text-sm">S/${o.price.toLocaleString("en-US")}</p>
            </div>
            <div class="flex items-center gap-2">
              <button onclick="updateQuantity(${n}, ${r-1})" class="w-6 h-6 border border-gray-300 rounded flex items-center justify-center hover:bg-gray-50">
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path>
                </svg>
              </button>
              <span class="w-8 text-center text-sm">${r}</span>
              <button onclick="updateQuantity(${n}, ${r+1})" class="w-6 h-6 border border-gray-300 rounded flex items-center justify-center hover:bg-gray-50">
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                </svg>
              </button>
            </div>
            <button onclick="removeFromCart(${n})" class="text-red-500 hover:text-red-700">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
              </svg>
            </button>
          </div>
        `}}),d&&(d.innerHTML=i),g&&(g.textContent=`S/${a.toLocaleString("en-US")}`)}function L(e,t){const a=JSON.parse(localStorage.getItem("figure-store")||'{"cart": {}, "wishlist": []}');t<=0?delete a.cart[e]:a.cart[e]=t,localStorage.setItem("figure-store",JSON.stringify(a)),window.dispatchEvent(new CustomEvent("cartUpdated")),u()}function b(e){const t=JSON.parse(localStorage.getItem("figure-store")||'{"cart": {}, "wishlist": []}');delete t.cart[e],localStorage.setItem("figure-store",JSON.stringify(t)),window.dispatchEvent(new CustomEvent("cartUpdated")),u()}function C(){const e=JSON.parse(localStorage.getItem("figure-store")||'{"cart": {}, "wishlist": []}');e.cart={},localStorage.setItem("figure-store",JSON.stringify(e)),window.dispatchEvent(new CustomEvent("cartUpdated")),u()}function T(){const t=JSON.parse(localStorage.getItem("figure-store")||'{"cart": {}, "wishlist": []}').cart;if(Object.keys(t).length===0){alert("Tu carrito está vacío");return}let a=`Hola! Quiero comprar los siguientes productos:

`,i=0;Object.entries(t).forEach(([r,o])=>{const l=M[r];if(l){const S=l.price*o;i+=S,a+=`• ${l.name} x${o} - S/${S.toLocaleString("en-US")}
`}}),a+=`
Total: S/${i.toLocaleString("en-US")}`;const n=encodeURIComponent(a);window.open(`https://wa.me/51949799869?text=${n}`,"_blank"),C(),h()}E?.addEventListener("click",h);v?.addEventListener("click",C);w?.addEventListener("click",T);m?.addEventListener("click",e=>{e.target===m&&h()});window.openCart=k;window.updateQuantity=L;window.removeFromCart=b;
